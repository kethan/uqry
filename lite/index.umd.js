!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).uqry={})}(this,(function(e){const r=(e,t)=>{if(e===t)return!0;if(null==e||null==t||typeof e!=typeof t)return!1;if("object"==typeof e){if(e.map!==t.map)return!1;const n=Object.keys(e),i=Object.keys(t);return n.length===i.length&&n.every((n=>r(e[n],t[n])))}return!1},t={$eq:r,$ne:(e,t)=>!r(e,t),$gt:(e,r)=>r>e,$gte:(e,r)=>r>=e,$lt:(e,r)=>r<e,$lte:(e,r)=>r<=e,$in:(e,r)=>(Array.isArray(e)?e:[e]).some((e=>n(e)(r))),$nin:(e,r)=>!(Array.isArray(e)?e:[e]).some((e=>n(e)(r))),$and:(e,r)=>e.every((e=>n(e)(r))),$or:(e,r)=>e.some((e=>n(e)(r))),$not:(e,r)=>!n(e)(r),$regex:(e,r)=>new RegExp(e).test(r),$exists:(e,r)=>void 0!==r,$type:(e,r)=>typeof r===e,$elemMatch:(e,r)=>(Array.isArray(r)?r:[r]).some((r=>n(e)(r))),$all:(e,r)=>Array.isArray(r)&&e.every((e=>r.some((r=>n(e)(r))))),$size:(e,r)=>!!Array.isArray(r)&&r.length===e},n=e=>i=>"object"!=typeof e||Array.isArray(e)?r(i,e):Object.entries(e).every((([e,r])=>"string"==typeof e&&e.startsWith("$")?t[e](r,i):n(r)(((e,r)=>(Array.isArray(r)?r:r.split(".")).reduce(((e,r)=>e?e[r]:e),e))(i,e))));e.add=(e,r,n)=>t[r]=n,e.filter=n,e.isEqual=r}));